<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>书签管理插件</title>
    <link rel="stylesheet" href="option.css">
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-item active" data-page="all-bookmarks">所有书签</div>
        <div class="sidebar-item" data-page="page-1">收藏夹</div>
        <div class="sidebar-item" data-page="page-2">标签检索</div>
        <div class="sidebar-item" data-page="api-settings">API设置</div>
    </div>

    <div class="main-content">
        <div class="container">
            <!-- 所有书签页面 -->
            <div id="all-bookmarks" class="page-view active">
                <div class="header">
                    <h1>我的书签</h1>
                    <p>管理您在浏览器中收藏的所有网站</p>
                </div>

                <div class="toolbar">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="搜索书签">
                    </div>
                    <div class="stats">
                        <div class="stat-item">
                            <div class="stat-number" id="totalCount">0</div>
                            <div class="stat-label">总书签数</div>
                        </div>
                    </div>
                    <button class="refresh-btn" id="refreshBtn">刷新</button>
                </div>

                <div class="bookmarks-container">
                    <div id="loading" class="loading">
                        <div class="loading-spinner"></div>
                        <div>正在加载书签...</div>
                    </div>

                    <div id="bookmarksList" class="bookmarks-list" style="display: none;"></div>

                    <div id="emptyState" class="empty-state" style="display: none;">
                        <div class="empty-state-icon">—</div>
                        <div class="empty-state-text">暂无书签</div>
                        <div class="empty-state-hint">请在浏览器中添加书签后刷新</div>
                    </div>
                </div>
            </div>

            <!-- 收藏夹页面 -->
            <div id="page-1" class="page-view">
                <div class="folders-page-container">
                    <!-- 左侧收藏夹树 -->
                    <div class="folders-tree">
                        <div class="folders-tree-header">
                            <h2>收藏夹</h2>
                        </div>
                        <div class="folders-tree-content" id="foldersTree">
                            <div class="loading">
                                <div class="loading-spinner"></div>
                                <div>正在加载...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧内容区 -->
                    <div class="folders-main">
                        <!-- 面包屑导航 -->
                        <div class="folders-breadcrumb" id="foldersBreadcrumb">
                            <span class="breadcrumb-item active" data-folder-id="0">收藏夹</span>
                        </div>
                        
                        <!-- 内容显示区 -->
                        <div class="folders-view">
                            <div id="foldersViewContent" class="folders-view-content">
                                <div class="loading">
                                    <div class="loading-spinner"></div>
                                    <div>正在加载...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 标签检索页面 -->
            <div id="page-2" class="page-view">
                <div class="header">
                    <h1>标签检索</h1>
                    <p>浏览和管理所有标签</p>
                </div>
                <div class="tags-search-container">
                    <div id="tagsList" class="tags-list">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <div>正在加载标签...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API设置页面 -->
            <div id="api-settings" class="page-view">
                <div class="header">
                    <h1>API设置</h1>
                    <p>配置大模型API以启用智能标签生成功能</p>
                </div>

                <div class="api-settings-container">
                    <div class="api-settings-form">
                        <!-- 当前配置显示 -->
                        <div class="form-section">
                            <div class="current-config-card" id="currentConfigCard" style="display: none;">
                                <div class="current-config-header">
                                    <h3>当前配置</h3>
                                    <span class="current-config-status" id="currentConfigStatus"></span>
                                </div>
                                <div class="current-config-content" id="currentConfigContent">
                                    <div class="current-config-item">
                                        <span class="current-config-label">状态：</span>
                                        <span class="current-config-value" id="currentConfigEnabled"></span>
                                    </div>
                                    <div class="current-config-item">
                                        <span class="current-config-label">提供商：</span>
                                        <span class="current-config-value" id="currentConfigProvider"></span>
                                    </div>
                                    <div class="current-config-item">
                                        <span class="current-config-label">端点：</span>
                                        <span class="current-config-value" id="currentConfigEndpoint"></span>
                                    </div>
                                    <div class="current-config-item">
                                        <span class="current-config-label">模型：</span>
                                        <span class="current-config-value" id="currentConfigModel"></span>
                                    </div>
                                    <div class="current-config-item" id="currentConfigAdvanced" style="display: none;">
                                        <span class="current-config-label">高级参数：</span>
                                        <span class="current-config-value" id="currentConfigAdvancedParams"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 功能开关 -->
                        <div class="form-section">
                            <div class="form-group">
                                <label class="form-label">
                                    <input type="checkbox" id="apiEnabled" class="checkbox-input">
                                    <span>启用智能标签生成</span>
                                </label>
                                <div class="form-hint">开启后，收藏网站时将自动使用AI生成标签</div>
                            </div>
                        </div>

                        <!-- API提供商选择 -->
                        <div class="form-section">
                            <div class="form-group">
                                <label for="apiProvider" class="form-label-text">API提供商</label>
                                <select id="apiProvider" class="form-input">
                                    <option value="openai">OpenAI</option>
                                    <option value="claude">Anthropic Claude</option>
                                    <option value="deepseek">DeepSeek</option>
                                    <option value="custom">自定义API</option>
                                </select>
                                <div class="form-hint">选择您使用的大模型API提供商</div>
                            </div>
                        </div>

                        <!-- API端点 -->
                        <div class="form-section">
                            <div class="form-group">
                                <label for="apiEndpoint" class="form-label-text">API端点</label>
                                <input type="text" id="apiEndpoint" class="form-input" placeholder="https://api.openai.com/v1/chat/completions">
                                <div class="form-hint">API的完整URL地址</div>
                            </div>
                        </div>

                        <!-- API Key -->
                        <div class="form-section">
                            <div class="form-group">
                                <label for="apiKey" class="form-label-text">API Key</label>
                                <div class="form-input-group">
                                    <input type="password" id="apiKey" class="form-input" placeholder="输入您的API Key">
                                    <button type="button" id="toggleApiKey" class="form-toggle-btn" title="显示/隐藏">👁</button>
                                </div>
                                <div class="form-hint">您的API密钥，将加密存储</div>
                            </div>
                        </div>

                        <!-- 模型选择 -->
                        <div class="form-section">
                            <div class="form-group">
                                <label for="apiModel" class="form-label-text">模型</label>
                                <input type="text" id="apiModel" class="form-input" placeholder="gpt-3.5-turbo" list="modelSuggestions">
                                <datalist id="modelSuggestions"></datalist>
                                <div class="form-hint">要使用的模型名称</div>
                            </div>
                        </div>

                        <!-- 高级设置 -->
                        <div class="form-section">
                            <div class="form-group">
                                <button type="button" id="toggleAdvanced" class="form-toggle-advanced">
                                    <span>高级设置</span>
                                    <span class="toggle-icon">▼</span>
                                </button>
                            </div>
                            <div id="advancedSettings" class="advanced-settings" style="display: none;">
                                <!-- 温度参数 -->
                                <div class="form-group">
                                    <label for="apiTemperature" class="form-label-text">
                                        温度 (Temperature)
                                        <span id="temperatureValue" class="value-display">0.7</span>
                                    </label>
                                    <input type="range" id="apiTemperature" class="form-range" min="0" max="2" step="0.1" value="0.7">
                                    <div class="form-hint">控制输出的随机性，范围：0-2（0=确定性，2=随机性）</div>
                                </div>

                                <!-- 最大Token数 -->
                                <div class="form-group">
                                    <label for="apiMaxTokens" class="form-label-text">最大Token数</label>
                                    <input type="number" id="apiMaxTokens" class="form-input" min="1" max="4000" value="500">
                                    <div class="form-hint">生成响应的最大token数，范围：1-4000</div>
                                </div>

                                <!-- 超时时间 -->
                                <div class="form-group">
                                    <label for="apiTimeout" class="form-label-text">超时时间（毫秒）</label>
                                    <input type="number" id="apiTimeout" class="form-input" min="1000" max="120000" step="1000" value="30000">
                                    <div class="form-hint">API请求的超时时间，范围：1000-120000毫秒</div>
                                </div>
                            </div>
                        </div>

                        <!-- 操作按钮 -->
                        <div class="form-section">
                            <div class="form-actions">
                                <button type="button" id="saveApiConfig" class="btn btn-primary">保存配置</button>
                                <button type="button" id="testApiConfig" class="btn btn-secondary">测试连接</button>
                                <button type="button" id="resetApiConfig" class="btn btn-link">重置为默认值</button>
                            </div>
                        </div>

                        <!-- 状态提示 -->
                        <div id="apiConfigStatus" class="api-status" style="display: none;"></div>
                    </div>

                    <!-- 说明文档 -->
                    <div class="api-settings-help">
                        <h3>使用说明</h3>
                        <div class="help-content">
                            <h4>1. OpenAI</h4>
                            <p>使用OpenAI API需要：</p>
                            <ul>
                                <li>注册OpenAI账号并获取API Key</li>
                                <li>API端点：<code>https://api.openai.com/v1/chat/completions</code></li>
                                <li>推荐模型：<code>gpt-3.5-turbo</code> 或 <code>gpt-4</code></li>
                            </ul>

                            <h4>2. Anthropic Claude</h4>
                            <p>使用Claude API需要：</p>
                            <ul>
                                <li>注册Anthropic账号并获取API Key</li>
                                <li>API端点：<code>https://api.anthropic.com/v1/messages</code></li>
                                <li>推荐模型：<code>claude-3-sonnet-20240229</code></li>
                            </ul>

                            <h4>3. DeepSeek</h4>
                            <p>使用DeepSeek API需要：</p>
                            <ul>
                                <li>注册DeepSeek账号并获取API Key</li>
                                <li>API端点：<code>https://api.deepseek.com/v1/chat/completions</code></li>
                                <li>推荐模型：<code>deepseek-chat</code> 或 <code>deepseek-coder</code></li>
                            </ul>

                            <h4>4. 自定义API</h4>
                            <p>支持自定义API端点，需要：</p>
                            <ul>
                                <li>兼容OpenAI格式的API接口</li>
                                <li>提供完整的API端点和密钥</li>
                                <li>确保API支持文本生成功能</li>
                            </ul>

                            <div class="help-note">
                                <strong>隐私提示：</strong>启用智能标签功能后，页面内容将被发送到配置的API进行分析。请确保您信任所使用的API服务。
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../utils/apiConfig.js"></script>
    <script src="option.js"></script>
</body>
</html>